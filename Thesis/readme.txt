Much of this code is still in progress
